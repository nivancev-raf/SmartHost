<!-- Finance Header -->
<div class="finance-header">
  <div class="header-content">
    <h1>Financial Management</h1>
    <p>Track income and revenue across all your apartments</p>
  </div>
</div>

<!-- Loading State -->
<div *ngIf="isLoading" class="loading-section">
  <mat-card class="loading-card">
    <mat-card-content>
      <div class="loading-content">
        <mat-progress-spinner mode="indeterminate" diameter="50"></mat-progress-spinner>
        <p>Loading financial data...</p>
      </div>
    </mat-card-content>
  </mat-card>
</div>

<!-- No Data State -->
<div *ngIf="!isLoading && apartments.length === 0" class="no-data-section">
  <mat-card class="no-data-card">
    <mat-card-content>
      <div class="no-data-content">
        <mat-icon>account_balance_wallet</mat-icon>
        <h2>No Financial Data</h2>
        <p>No apartments or completed reservations found. Start by adding apartments and getting bookings!</p>
      </div>
    </mat-card-content>
  </mat-card>
</div>

<!-- Finance Dashboard -->
<div *ngIf="!isLoading && apartments.length > 0" class="finance-dashboard">
  
  <!-- Summary Cards -->
  <div class="summary-section">
    <div class="summary-grid">
      <!-- Daily Income Card -->
      <mat-card class="summary-card daily-card">
        <div class="summary-content">
          <div class="summary-icon daily-icon">
            <mat-icon>today</mat-icon>
          </div>
          <div class="summary-details">
            <h3>{{ formatCurrency(financeSummary.totalDaily, financeSummary.currency) }}</h3>
            <p>Today's Income</p>
          </div>
        </div>
      </mat-card>

      <!-- Monthly Income Card -->
      <mat-card class="summary-card monthly-card">
        <div class="summary-content">
          <div class="summary-icon monthly-icon">
            <mat-icon>calendar_month</mat-icon>
          </div>
          <div class="summary-details">
            <h3>{{ formatCurrency(financeSummary.totalMonthly, financeSummary.currency) }}</h3>
            <p>This Month's Income</p>
          </div>
        </div>
      </mat-card>

      <!-- Annual Income Card -->
      <mat-card class="summary-card annual-card">
        <div class="summary-content">
          <div class="summary-icon annual-icon">
            <mat-icon>trending_up</mat-icon>
          </div>
          <div class="summary-details">
            <h3>{{ formatCurrency(financeSummary.totalAnnual, financeSummary.currency) }}</h3>
            <p>This Year's Income</p>
          </div>
        </div>
      </mat-card>

      <!-- Properties Count Card -->
      <mat-card class="summary-card properties-card">
        <div class="summary-content">
          <div class="summary-icon properties-icon">
            <mat-icon>apartment</mat-icon>
          </div>
          <div class="summary-details">
            <h3>{{ financeSummary.apartmentCount }}</h3>
            <p>Active Properties</p>
          </div>
        </div>
      </mat-card>
    </div>
  </div>

  <!-- Detailed Income Table -->
  <div class="income-table-section">
    <mat-card class="income-table-card">
      <div class="table-header">
        <h2>
          <mat-icon>analytics</mat-icon>
          Income by Property
        </h2>
        <p>Detailed breakdown of income per apartment</p>
      </div>

      <mat-card-content>
        <div class="table-container">
          <table mat-table [dataSource]="incomeData" class="income-table">
            
            <!-- Apartment Column -->
            <ng-container matColumnDef="apartment">
              <th mat-header-cell *matHeaderCellDef class="apartment-header">
                <mat-icon>apartment</mat-icon>
                Property
              </th>
              <td mat-cell *matCellDef="let income" class="apartment-cell">
                <div class="apartment-info">
                  <div class="apartment-avatar">
                    <mat-icon>home</mat-icon>
                  </div>
                  <div class="apartment-details">
                    <span class="apartment-name">{{ income.apartmentName }}</span>
                    <span class="apartment-id">ID: {{ income.apartmentId }}</span>
                  </div>
                </div>
              </td>
            </ng-container>

            <!-- Daily Income Column -->
            <ng-container matColumnDef="daily">
              <th mat-header-cell *matHeaderCellDef class="income-header daily-header">
                <mat-icon>today</mat-icon>
                Today
              </th>
              <td mat-cell *matCellDef="let income" class="income-cell daily-cell">
                <div class="income-amount">
                  {{ formatCurrency(income.daily, income.currency) }}
                </div>
              </td>
            </ng-container>

            <!-- Monthly Income Column -->
            <ng-container matColumnDef="monthly">
              <th mat-header-cell *matHeaderCellDef class="income-header monthly-header">
                <mat-icon>calendar_month</mat-icon>
                This Month
              </th>
              <td mat-cell *matCellDef="let income" class="income-cell monthly-cell">
                <div class="income-amount">
                  {{ formatCurrency(income.monthly, income.currency) }}
                </div>
              </td>
            </ng-container>

            <!-- Annual Income Column -->
            <ng-container matColumnDef="annual">
              <th mat-header-cell *matHeaderCellDef class="income-header annual-header">
                <mat-icon>trending_up</mat-icon>
                This Year
              </th>
              <td mat-cell *matCellDef="let income" class="income-cell annual-cell">
                <div class="income-amount annual-amount">
                  {{ formatCurrency(income.annual, income.currency) }}
                </div>
              </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;" class="income-row"></tr>
          </table>
        </div>

        <!-- Table Footer with Totals -->
        <div class="table-footer">
          <div class="footer-totals">
            <div class="total-item">
              <span class="total-label">Daily Total:</span>
              <span class="total-value">{{ formatCurrency(financeSummary.totalDaily, financeSummary.currency) }}</span>
            </div>
            <div class="total-item">
              <span class="total-label">Monthly Total:</span>
              <span class="total-value">{{ formatCurrency(financeSummary.totalMonthly, financeSummary.currency) }}</span>
            </div>
            <div class="total-item">
              <span class="total-label">Annual Total:</span>
              <span class="total-value annual-total">{{ formatCurrency(financeSummary.totalAnnual, financeSummary.currency) }}</span>
            </div>
          </div>
        </div>
      </mat-card-content>
    </mat-card>
  </div>
</div>
