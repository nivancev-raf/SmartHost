<div class="apartment-details-dialog">
  <div mat-dialog-title class="dialog-header">
    <h2>{{apartment.name}}</h2>
    <button mat-icon-button (click)="onClose()" class="close-btn">
      <mat-icon>close</mat-icon>
    </button>
  </div>

  <div mat-dialog-content class="dialog-content">
    <!-- Image Gallery Section -->
    <div class="image-gallery">
      <div class="main-image-container">
        <img [src]="currentImageUrl" [alt]="apartment.name" class="main-image">
        
        <!-- Navigation arrows for multiple images -->
        <div *ngIf="hasMultipleImages" class="image-nav">
          <button mat-icon-button (click)="previousImage()" class="nav-btn prev-btn">
            <mat-icon>chevron_left</mat-icon>
          </button>
          <button mat-icon-button (click)="nextImage()" class="nav-btn next-btn">
            <mat-icon>chevron_right</mat-icon>
          </button>
        </div>

        <!-- Image indicators -->
        <div *ngIf="hasMultipleImages" class="image-indicators">
          <button 
            *ngFor="let image of apartment.images; let i = index"
            (click)="setImage(i)"
            [class.active]="i === currentImageIndex"
            class="indicator">
          </button>
        </div>
      </div>

      <!-- Thumbnail strip -->
      <div *ngIf="hasMultipleImages && apartment.images!.length > 1" class="thumbnail-strip">
        <img 
          *ngFor="let image of apartment.images; let i = index"
          [src]="image.url" 
          [alt]="apartment.name + ' - Image ' + (i + 1)"
          (click)="setImage(i)"
          [class.active]="i === currentImageIndex"
          class="thumbnail">
      </div>
    </div>

    <!-- Apartment Details Section -->
    <div class="apartment-info">
      <!-- Basic Info -->
      <div class="basic-info">
        <div class="location-rating">
          <div class="location">
            <mat-icon>location_on</mat-icon>
            <span>{{apartment.address}}, {{apartment.city}}</span>
          </div>
          
          <div class="rating" *ngIf="apartment.rating">
            <div class="stars">
              <mat-icon 
                *ngFor="let filled of getStarArray()" 
                [class.filled]="filled">
                star
              </mat-icon>
            </div>
            <span class="rating-text">{{apartment.rating}}</span>
          </div>
        </div>

        <!-- Status (Admin View) -->
        <div *ngIf="isAdminView" class="status-section">
          <mat-chip 
            [style.background-color]="getStatusColor()" 
            [style.color]="'white'"
            class="status-chip">
            {{getStatusText()}}
          </mat-chip>
        </div>

        <!-- Price -->
        <div class="price-section">
          <span class="price">{{formattedPrice}}</span>
          <span class="price-unit">/ night</span>
        </div>
      </div>

      <mat-divider></mat-divider>

      <!-- Property Details -->
      <div class="property-details">
        <h3>Property Details</h3>
        <div class="details-grid">
          <div class="detail-item" *ngIf="apartment.maxGuests">
            <mat-icon>people</mat-icon>
            <span>{{apartment.maxGuests}} guests</span>
          </div>
          
          <div class="detail-item" *ngIf="apartment.bedrooms">
            <mat-icon>bed</mat-icon>
            <span>{{apartment.bedrooms}} bedroom{{apartment.bedrooms > 1 ? 's' : ''}}</span>
          </div>
          
          <div class="detail-item" *ngIf="apartment.bathrooms">
            <mat-icon>bathtub</mat-icon>
            <span>{{apartment.bathrooms}} bathroom{{apartment.bathrooms > 1 ? 's' : ''}}</span>
          </div>
          
          <div class="detail-item" *ngIf="apartment.sizeM2">
            <mat-icon>square_foot</mat-icon>
            <span>{{apartment.sizeM2}} mÂ²</span>
          </div>
          
          <div class="detail-item" *ngIf="apartment.floor">
            <mat-icon>layers</mat-icon>
            <span>Floor {{apartment.floor}}</span>
          </div>
        </div>
      </div>

      <mat-divider></mat-divider>

      <!-- Description -->
      <div class="description-section" *ngIf="apartment.description">
        <h3>Description</h3>
        <p>{{apartment.description}}</p>
      </div>

      <mat-divider></mat-divider>

      <!-- Amenities -->
      <div class="amenities-section" *ngIf="apartment.amenities && apartment.amenities.length > 0">
        <h3>Amenities</h3>
        <div class="amenities-list">
          <mat-chip *ngFor="let amenity of apartment.amenities">
            {{amenity.name}}
          </mat-chip>
        </div>
      </div>

      <!-- Admin Only Info -->
      <div *ngIf="isAdminView" class="admin-info">
        <mat-divider></mat-divider>
        <h3>Management Info</h3>
        <div class="admin-details">
          <p><strong>Property ID:</strong> {{apartment.id}}</p>
          <p><strong>Created:</strong> {{apartment.createdAt | date:'medium'}}</p>
          <p><strong>Owner ID:</strong> {{apartment.ownerId}}</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Dialog Actions -->
  <div mat-dialog-actions class="dialog-actions">
    <div class="actions-left">
      <button mat-button (click)="onClose()" class="cancel-btn">
        Close
      </button>
    </div>

    <div class="actions-right">
      <!-- Guest/Client Actions -->
      <ng-container *ngIf="!isAdminView && apartment.status === 'AVAILABLE'">
        <button mat-raised-button color="primary" (click)="onBook()" class="book-btn">
          <mat-icon>calendar_today</mat-icon>
          Book Now
        </button>
      </ng-container>

      <!-- Admin Actions -->
      <ng-container *ngIf="isAdminView">
        <button mat-button (click)="onEdit()" class="edit-btn">
          <mat-icon>edit</mat-icon>
          Edit
        </button>
        <button mat-button color="warn" (click)="onDelete()" class="delete-btn">
          <mat-icon>delete</mat-icon>
          Delete
        </button>
      </ng-container>
    </div>
  </div>
</div>
